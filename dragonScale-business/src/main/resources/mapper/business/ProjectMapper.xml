<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dragonScale.business.mapper.ProjectMapper">
    <resultMap type="YwProject" id="YwProjectResult">
        <result property="userId"    column="USER_ID"    />
        <result property="pkProject"    column="PK_PROJECT"    />
        <result property="createdBy"    column="CREATED_BY"    />
        <result property="createdTime"    column="CREATED_TIME"    />
        <result property="updatedBy"    column="UPDATED_BY"    />
        <result property="updatedTime"    column="UPDATED_TIME"    />
        <result property="dr"    column="DR"    />
        <result property="name"    column="NAME"    />
        <collection property="ywVideoList" notNullColumn="PK_VIDEO" javaType="java.util.List"  select="selectVideoList" column="PK_PROJECT" />
    </resultMap>
    <resultMap type="YwVideo" id="YwVideoResult">
        <result property="pkVideo"    column="PK_VIDEO"    />
        <result property="createdBy"    column="CREATED_BY"    />
        <result property="createdTime"    column="CREATED_TIME"    />
        <result property="updatedBy"    column="UPDATED_BY"    />
        <result property="updatedTime"    column="UPDATED_TIME"    />
        <result property="dr"    column="DR"    />
        <result property="name"    column="NAME" />
    </resultMap>

    <sql id="selectYwProjectVo">
        select USER_ID, PK_PROJECT, CREATED_BY, CREATED_TIME, UPDATED_BY, UPDATED_TIME, DR, NAME from yw_project
    </sql>
    <select id="selectYwProjectList" resultMap="YwProjectResult">
       <include refid="selectYwProjectVo"></include>
        <where>
            DR = '1'
        </where>
    </select>
    
    <select id="selectVideoList" resultMap="YwVideoResult">
        select * from yw_video where PK_VIDEO in (  select pk_video from yw_project_video where pk_project = #{PK_PROJECT} and DR = '1')
    </select>

</mapper>